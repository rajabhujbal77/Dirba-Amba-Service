import{_ as V}from"./vendor-pdf-DRk-497H.js";import{r as g,j as e}from"./vendor-radix-BK0gN1wx.js";import{b as G}from"./index-ByUUsPfb.js";import"./vendor-react-BRY8hXab.js";import"./vendor-state-B-0uGrSJ.js";function Y({assignedDepotId:j}){const[b,P]=g.useState(""),[N,R]=g.useState("all"),[l,F]=g.useState(null),[z,$]=g.useState([]),[M,I]=g.useState(!0),[E,v]=g.useState(!1);g.useEffect(()=>{O()},[]);const O=async()=>{try{const{bookings:s}=await G.getAll();let r=(s||[]).map(t=>{var i,m;return{id:t.receipt_number||t.id,bookingId:t.id,customer:t.sender_name||t.customer_name||"N/A",customerPhone:t.sender_phone||t.customer_phone||"",destination:t.destination_depot_name||t.destination_location||"N/A",date:t.created_at,amount:Number(t.total_amount)||0,paymentMode:((m=(i=t.payment_method)==null?void 0:i.replace("_"," "))==null?void 0:m.toUpperCase())||"Cash",status:t.payment_method==="credit"||t.payment_method==="to_pay"?"pending":"paid",booking_status:t.status,invoiceNumber:t.receipt_number||t.id,receivers:t.receivers||[],destination_depot_id:t.destination_depot_id,origin_depot_id:t.origin_depot_id}});j&&(r=r.filter(t=>(t.destination_depot_id===j||t.origin_depot_id===j)&&t.booking_status!=="booked")),$(r)}catch(s){console.error("Error loading receipts:",s)}finally{I(!1)}},D=s=>{F(s),v(!0)},T=s=>{F(s),v(!0),setTimeout(()=>window.print(),100)},w=async s=>{const{jsPDF:r}=await V(async()=>{const{jsPDF:u}=await import("./vendor-pdf-DRk-497H.js").then(p=>p.j);return{jsPDF:u}},[]),t=new r({format:"a5",unit:"mm",orientation:"landscape"}),i=t.internal.pageSize.getWidth(),m=t.internal.pageSize.getHeight(),d=12;let a=12;t.setFontSize(18),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("DRT MANGO TRANSPORT",i/2,a,{align:"center"}),a+=5,t.setFontSize(8),t.setFont("helvetica","normal"),t.setTextColor(80,80,80),t.text("AT POST JAMSANDE, TAL.DEVGAD, DIST. SINDHUDURG | MOB: 9422584166, 9422435348",i/2,a,{align:"center"}),t.setTextColor(0,0,0),a+=6,t.setDrawColor(200,200,200),t.setLineWidth(.3),t.line(d,a,i-d,a),a+=6,t.setFontSize(10),t.setFont("helvetica","bold"),t.text(`Receipt No: ${s.id}`,d,a),t.setFont("helvetica","normal"),t.text(`Date: ${new Date(s.date).toLocaleDateString("en-IN")}`,i-d,a,{align:"right"}),a+=7,t.setFontSize(12),t.setFont("helvetica","bold"),t.text(`Destination: ${s.destination||"N/A"}`,d,a),a+=6,t.setFontSize(10),t.setFont("helvetica","normal"),t.text(`Sender: ${s.customer||"N/A"} (${s.customerPhone||"N/A"})`,d,a),a+=8;const c=d,y=i-2*c,o={srNo:12,receiver:55,packageSize:40,qty:20},h=7,q=m-35;t.setFillColor(51,51,51),t.rect(c,a,y,h,"F"),t.setTextColor(255,255,255),t.setFontSize(9),t.setFont("helvetica","bold");let n=c+3;t.text("Sr.",n,a+5),n+=o.srNo,t.text("Receiver",n,a+5),n+=o.receiver,t.text("Package Size",n,a+5),n+=o.packageSize,t.text("Qty",n,a+5),n+=o.qty,t.text("Amount",n,a+5),a+=h,t.setTextColor(0,0,0),t.setFont("helvetica","normal");let S=0,f=0;s.receivers&&s.receivers.length>0&&s.receivers.forEach(u=>{u.packages&&u.packages.length>0&&u.packages.forEach((p,k)=>{a>q&&(t.addPage(),a=15),S++;const A=p.quantity*p.price_per_unit;f+=A,S%2===0&&(t.setFillColor(248,248,248),t.rect(c,a,y,h,"F")),t.setDrawColor(220,220,220);const L=k===0?h+3:h;if(t.rect(c,a,y,L,"S"),t.setFontSize(9),n=c+3,t.text(`${S}`,n,a+5),n+=o.srNo,k===0){const H=`${u.name||"N/A"}`.substring(0,22);t.setFont("helvetica","bold"),t.text(H,n,a+4),t.setFontSize(8),t.setFont("helvetica","normal"),t.setTextColor(100,100,100),t.text(`${u.phone||""}`,n,a+8),t.setTextColor(0,0,0),t.setFontSize(9)}n+=o.receiver,t.text(p.size||"N/A",n,a+5),n+=o.packageSize,t.text(`${p.quantity}`,n,a+5),n+=o.qty,t.text(`₹${A.toFixed(0)}`,n,a+5),a+=L})}),f===0&&(f=s.amount||0),t.setFillColor(51,51,51),t.rect(c,a,y,h+2,"F"),t.setTextColor(255,255,255),t.setFontSize(11),t.setFont("helvetica","bold"),t.text(`Payment: ${s.paymentMode||"CASH"}`,c+3,a+6);const W=c+o.srNo+o.receiver+o.packageSize+o.qty+3;t.text(`TOTAL: ₹${f.toLocaleString("en-IN")}`,W,a+6),a+=h+8,t.setTextColor(0,0,0),t.setFontSize(9),t.setFont("helvetica","normal"),t.setTextColor(100,100,100),t.text("Thank you for choosing DRT Mango Transport!",i/2,a,{align:"center"}),t.setTextColor(0,0,0),a+=12;const _=45,C=i-d-_;t.setDrawColor(150,150,150),t.setLineWidth(.4),t.line(C,a,C+_,a),a+=4,t.setFontSize(8),t.setFont("helvetica","normal"),t.text("Authorized Signature",C+_/2,a,{align:"center"}),t.save(`${s.id}.pdf`)},x=z.filter(s=>{if(!b.trim())return N==="all"||s.status===N;const r=b.toLowerCase(),t=(s.customer||"").toLowerCase().includes(r)||(s.bookingId||"").toLowerCase().includes(r)||(s.id||"").toLowerCase().includes(r)||(s.destination||"").toLowerCase().includes(r),i=N==="all"||s.status===N;return t&&i});return x.reduce((s,r)=>s+r.amount,0),x.filter(s=>s.status==="paid").reduce((s,r)=>s+r.amount,0),x.filter(s=>s.status==="pending").reduce((s,r)=>s+r.amount,0),M?e.jsx("div",{className:"p-8",children:"Loading receipts..."}):e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"All Receipts"}),e.jsx("p",{className:"text-gray-600",children:"View and manage all payment receipts"})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by customer, booking ID, or receipt number...",value:b,onChange:s=>P(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})}),e.jsx("div",{children:e.jsxs("select",{value:N,onChange:s=>R(s.target.value),className:"w-full md:w-48 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"pending",children:"Pending"})]})})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden hidden md:block",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receipt Details"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment Mode"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:x.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.id}),e.jsx("p",{className:"text-sm text-gray-600",children:s.invoiceNumber}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Booking: ",s.bookingId]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"font-medium text-gray-900",children:s.customer})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("p",{className:"text-sm text-gray-900",children:new Date(s.date).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("p",{className:"font-bold text-gray-900",children:["₹",s.amount.toLocaleString("en-IN")]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("p",{className:"text-sm text-gray-900",children:s.paymentMode})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${s.status==="paid"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>D(s),className:"text-sm text-orange-600 hover:text-orange-700 font-medium",children:"View"}),e.jsx("button",{onClick:()=>T(s),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Print"}),e.jsx("button",{onClick:()=>w(s),className:"text-sm text-green-600 hover:text-green-700 font-medium",children:"Download"})]})})]},s.id))})]})}),x.length===0&&e.jsx("div",{className:"p-12 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No receipts found matching your criteria"})})]}),e.jsxs("div",{className:"md:hidden space-y-4",children:[x.map(s=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900",children:s.id}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.date).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${s.status==="paid"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:s.status})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Customer"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.customer})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Amount"}),e.jsxs("span",{className:"text-sm font-bold text-gray-900",children:["₹",s.amount.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Payment"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.paymentMode})]})]}),e.jsxs("div",{className:"flex gap-3 pt-3 border-t border-gray-100",children:[e.jsx("button",{onClick:()=>D(s),className:"flex-1 py-2 text-sm text-orange-600 bg-orange-50 rounded-lg font-medium",children:"View"}),e.jsx("button",{onClick:()=>T(s),className:"flex-1 py-2 text-sm text-blue-600 bg-blue-50 rounded-lg font-medium",children:"Print"}),e.jsx("button",{onClick:()=>w(s),className:"flex-1 py-2 text-sm text-green-600 bg-green-50 rounded-lg font-medium",children:"Download"})]})]},s.id)),x.length===0&&e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No receipts found matching your criteria"})})]}),E&&l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 print:bg-white print:relative",children:e.jsxs("div",{className:"bg-white rounded-xl p-8 max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto print:rounded-none print:max-w-full print:mx-0",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 print:hidden",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Receipt Details"}),e.jsx("button",{onClick:()=>v(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"×"})]}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-orange-500",children:"DRT MANGO TRANSPORT"}),e.jsx("p",{className:"text-lg font-medium mt-2",children:l.id}),e.jsx("p",{className:"text-sm text-gray-600",children:new Date(l.date).toLocaleDateString("en-IN")})]}),e.jsxs("div",{className:"space-y-3 border-t border-b py-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Destination:"}),e.jsx("span",{className:"font-medium",children:l.destination})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Customer:"}),e.jsx("span",{className:"font-medium",children:l.customer})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Payment Mode:"}),e.jsx("span",{className:"font-medium",children:l.paymentMode})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:`font-medium ${l.status==="paid"?"text-green-600":"text-orange-600"}`,children:l.status.toUpperCase()})]})]}),l.receivers&&l.receivers.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Receivers & Packages:"}),l.receivers.map((s,r)=>{var t;return e.jsxs("div",{className:"ml-2 mb-2",children:[e.jsxs("p",{className:"font-medium",children:[s.name," (",s.phone,")"]}),(t=s.packages)==null?void 0:t.map((i,m)=>e.jsxs("p",{className:"text-sm text-gray-600 ml-4",children:[i.size," × ",i.quantity," = ₹",(i.quantity*i.price_per_unit).toFixed(0)]},m))]},r)})]}),e.jsx("div",{className:"mt-6 bg-yellow-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-bold",children:"TOTAL:"}),e.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["₹",l.amount.toLocaleString("en-IN")]})]})}),e.jsxs("div",{className:"mt-6 flex gap-3 print:hidden",children:[e.jsx("button",{onClick:()=>window.print(),className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Print"}),e.jsx("button",{onClick:()=>w(l),className:"flex-1 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600",children:"Download PDF"})]})]})})]})}export{Y as default};
//# sourceMappingURL=AllReceipts-CV0LaFDu.js.map
