{"version":3,"mappings":"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","names":["TripsDeliveries","userRole","assignedDepotId","activeTab","setActiveTab","useState","trips","setTrips","bookings","setBookings","depots","setDepots","isLoading","setIsLoading","statusFilter","setStatusFilter","toPayCollectionMethods","setToPayCollectionMethods","pendingDeliveries","setPendingDeliveries","isOnline","useOnlineStore","state","useSyncStore","useEffect","loadData","tripsRes","bookingsRes","depotsRes","tripsApi","bookingsApi","depotsApi","allTrips","allBookings","forwardingDestinationIds","depotRoutesApi","__vitePreload","n","err","filteredTrips","t","filteredBookings","b","error","handleMarkDelivered","bookingId","paymentMethod","updates","booking","tripId","autoCompleted","newMethods","isNetworkError","queueDeliveryOffline","queueOperation","prev","handleUpdateTripStatus","newStatus","downloadDriverMemo","trip","jsPDF","doc","pageWidth","y","depotOrderMap","depot","index","tripBookings","a","orderA","orderB","receiver","rIdx","pkg","getStatusColor","status","formatDate","dateStr","getPackageCount","count","r","p","deliveryBookings","jsxs","jsx","Fragment","_a","sum","e"],"ignoreList":[],"sources":["../../src/app/components/TripsDeliveries.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { tripsApi, bookingsApi, depotsApi } from '../utils/api';\r\n// jsPDF is dynamically imported when needed to reduce bundle size\r\nimport { useSyncStore, useOnlineStore } from '../stores';\r\nimport { queueOperation } from '../utils/syncEngine';\r\nimport { isNetworkError } from '../utils/networkErrors';\r\n\r\ninterface TripsDeliveriesProps {\r\n  userRole: 'owner' | 'booking_clerk' | 'depot_manager';\r\n  assignedDepotId?: string | null;\r\n}\r\n\r\ninterface Trip {\r\n  id: string;\r\n  trip_number: string;\r\n  driver_name: string;\r\n  driver_phone: string;\r\n  vehicle_number: string;\r\n  trip_cost: number;\r\n  status: string;\r\n  departure_time: string;\r\n  arrival_time: string;\r\n  created_at: string;\r\n  origin_depot_id: string;\r\n  destination_depot_id: string;\r\n  total_bookings: number;\r\n  delivered_bookings: number;\r\n}\r\n\r\ninterface Booking {\r\n  id: string;\r\n  receipt_number: string;\r\n  sender_name: string;\r\n  sender_phone: string;\r\n  destination_depot_name: string;\r\n  origin_depot_name: string;\r\n  total_amount: number;\r\n  status: string;\r\n  payment_method: string;\r\n  created_at: string;\r\n  receivers: any[];\r\n  trip_id?: string;\r\n}\r\n\r\nexport default function TripsDeliveries({ userRole, assignedDepotId }: TripsDeliveriesProps) {\r\n  const [activeTab, setActiveTab] = useState<'trips' | 'deliveries'>('trips');\r\n  const [trips, setTrips] = useState<Trip[]>([]);\r\n  const [bookings, setBookings] = useState<Booking[]>([]);\r\n  const [depots, setDepots] = useState<any[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [statusFilter, setStatusFilter] = useState<string>('all');\r\n  const [toPayCollectionMethods, setToPayCollectionMethods] = useState<Record<string, string>>({});\r\n\r\n  // Track which items are pending sync\r\n  const [pendingDeliveries, setPendingDeliveries] = useState<Set<string>>(new Set());\r\n\r\n  // Zustand stores for offline support\r\n  const isOnline = useOnlineStore((state) => state.isOnline);\r\n  const pendingOperations = useSyncStore((state) => state.pendingOperations);\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, []);\r\n\r\n  const loadData = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const [tripsRes, bookingsRes, depotsRes] = await Promise.all([\r\n        tripsApi.getAllWithProgress(),\r\n        bookingsApi.getAll(),\r\n        depotsApi.getAll()\r\n      ]);\r\n\r\n      const allTrips = tripsRes.trips || [];\r\n      let allBookings = bookingsRes.bookings || [];\r\n\r\n      // For depot managers, fetch their forwarding destinations\r\n      let forwardingDestinationIds: string[] = [];\r\n      if (userRole === 'depot_manager' && assignedDepotId) {\r\n        try {\r\n          const { depotRoutesApi } = await import('../utils/api');\r\n          const routesRes = await depotRoutesApi.getByDepotId(assignedDepotId);\r\n          forwardingDestinationIds = routesRes.forwardingDepotIds || [];\r\n          console.log('Forwarding destinations for Trips & Deliveries:', forwardingDestinationIds);\r\n        } catch (err) {\r\n          console.error('Error fetching depot routes:', err);\r\n        }\r\n      }\r\n\r\n      // Filter data for depot managers based on assigned depot OR forwarding destinations\r\n      const filteredTrips = userRole === 'depot_manager' && assignedDepotId\r\n        ? allTrips.filter((t: any) =>\r\n          t.origin_depot_id === assignedDepotId ||\r\n          t.destination_depot_id === assignedDepotId ||\r\n          forwardingDestinationIds.includes(t.destination_depot_id)\r\n        )\r\n        : allTrips;\r\n\r\n      // Depot managers Deliveries tab: Only show bookings where THIS depot is the final destination\r\n      // NOT bookings passing through for forwarding (those should only appear in Create Forwarding Trip)\r\n      const filteredBookings = userRole === 'depot_manager' && assignedDepotId\r\n        ? allBookings.filter((b: any) =>\r\n          (b.destination_depot_id === assignedDepotId ||\r\n            b.origin_depot_id === assignedDepotId) &&\r\n          b.status !== 'booked'\r\n        )\r\n        : allBookings;\r\n\r\n      setTrips(filteredTrips);\r\n      setBookings(filteredBookings);\r\n      // Depots come ordered by their position/id - use index as order\r\n      setDepots(depotsRes.depots || []);\r\n    } catch (error) {\r\n      console.error('Error loading data:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleMarkDelivered = async (bookingId: string, paymentMethod?: string) => {\r\n    // Build the updates object\r\n    const updates: any = paymentMethod ? {\r\n      status: 'delivered',\r\n      to_pay_collected_method: paymentMethod,\r\n      to_pay_collected_at: new Date().toISOString()\r\n    } : null;\r\n\r\n    if (isOnline) {\r\n      try {\r\n        // First get the booking to know its trip_id\r\n        const booking = bookings.find(b => b.id === bookingId);\r\n        const tripId = booking?.trip_id || (booking as any)?.trip_id;\r\n\r\n        if (paymentMethod) {\r\n          await bookingsApi.update(bookingId, updates);\r\n        } else {\r\n          await bookingsApi.updateStatus(bookingId, 'delivered');\r\n        }\r\n\r\n        // Check if trip should auto-complete (all managed depot deliveries done)\r\n        if (tripId) {\r\n          const { autoCompleted } = await tripsApi.checkAndAutoComplete(tripId);\r\n          if (autoCompleted) {\r\n            console.log(`Trip ${tripId} auto-completed after all managed deliveries done`);\r\n          }\r\n        }\r\n\r\n        // Clear the payment method selection for this booking\r\n        if (toPayCollectionMethods[bookingId]) {\r\n          const newMethods = { ...toPayCollectionMethods };\r\n          delete newMethods[bookingId];\r\n          setToPayCollectionMethods(newMethods);\r\n        }\r\n\r\n        await loadData(); // Refresh data\r\n      } catch (error: any) {\r\n        console.error('Error marking delivered:', error);\r\n\r\n        // If network error, queue it\r\n        if (isNetworkError(error)) {\r\n          console.log('[TripsDeliveries] Network error detected, queuing delivery');\r\n          queueDeliveryOffline(bookingId, paymentMethod, updates);\r\n        } else {\r\n          alert('Error marking as delivered');\r\n        }\r\n      }\r\n    } else {\r\n      // Offline: Queue the operation with optimistic UI\r\n      queueDeliveryOffline(bookingId, paymentMethod, updates);\r\n    }\r\n  };\r\n\r\n  // Helper to queue delivery marking offline\r\n  const queueDeliveryOffline = (bookingId: string, paymentMethod?: string, updates?: any) => {\r\n    const operationId = queueOperation('MARK_DELIVERED', {\r\n      bookingId,\r\n      paymentMethod,\r\n      updates\r\n    }, {\r\n      entityType: 'delivery',\r\n      entityId: bookingId,\r\n      optimisticData: { status: 'delivered', markedAt: new Date().toISOString() }\r\n    });\r\n\r\n    // Optimistic UI update\r\n    setPendingDeliveries(prev => new Set([...prev, bookingId]));\r\n\r\n    // Update local state optimistically\r\n    setBookings(prev => prev.map(b =>\r\n      b.id === bookingId ? { ...b, status: 'delivered' } : b\r\n    ));\r\n\r\n    // Clear the payment method selection\r\n    if (toPayCollectionMethods[bookingId]) {\r\n      const newMethods = { ...toPayCollectionMethods };\r\n      delete newMethods[bookingId];\r\n      setToPayCollectionMethods(newMethods);\r\n    }\r\n  };\r\n\r\n  const handleUpdateTripStatus = async (tripId: string, newStatus: string) => {\r\n    if (isOnline) {\r\n      try {\r\n        await tripsApi.update(tripId, { status: newStatus });\r\n        await loadData();\r\n      } catch (error: any) {\r\n        console.error('Error updating trip status:', error);\r\n\r\n        if (isNetworkError(error)) {\r\n          console.log('[TripsDeliveries] Network error detected, queuing trip update');\r\n          queueOperation('UPDATE_TRIP_STATUS', { tripId, status: newStatus }, {\r\n            entityType: 'trip',\r\n            entityId: tripId\r\n          });\r\n          // Optimistic update\r\n          setTrips(prev => prev.map(t =>\r\n            t.id === tripId ? { ...t, status: newStatus } : t\r\n          ));\r\n        } else {\r\n          alert('Error updating trip status');\r\n        }\r\n      }\r\n    } else {\r\n      // Offline: Queue with optimistic UI\r\n      queueOperation('UPDATE_TRIP_STATUS', { tripId, status: newStatus }, {\r\n        entityType: 'trip',\r\n        entityId: tripId\r\n      });\r\n      setTrips(prev => prev.map(t =>\r\n        t.id === tripId ? { ...t, status: newStatus } : t\r\n      ));\r\n    }\r\n  };\r\n\r\n  // Download Driver's Memo PDF\r\n  const downloadDriverMemo = async (trip: Trip) => {\r\n    // Dynamically import jsPDF to reduce bundle size\r\n    const { jsPDF } = await import('jspdf');\r\n    const doc = new jsPDF();\r\n    const pageWidth = doc.internal.pageSize.getWidth();\r\n    let y = 15;\r\n\r\n    // Header\r\n    doc.setFontSize(18);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text(\"DRIVER'S MEMO\", pageWidth / 2, y, { align: 'center' });\r\n    y += 8;\r\n    doc.setFontSize(12);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.text('DRT Mango Transport', pageWidth / 2, y, { align: 'center' });\r\n    y += 12;\r\n\r\n    // Trip Info\r\n    doc.setFontSize(11);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text('Trip Details', 14, y);\r\n    y += 6;\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setFontSize(10);\r\n    doc.text(`Trip Number: ${trip.trip_number || trip.id}`, 14, y); y += 5;\r\n    doc.text(`Driver: ${trip.driver_name} | Phone: ${trip.driver_phone || 'N/A'}`, 14, y); y += 5;\r\n    doc.text(`Vehicle: ${trip.vehicle_number}`, 14, y); y += 5;\r\n    doc.text(`Date: ${new Date().toLocaleDateString('en-IN')}`, 14, y); y += 10;\r\n\r\n    // Get bookings for THIS trip, sorted by destination depot order number\r\n    // Create depot order map: depot name -> order number (index + 1)\r\n    const depotOrderMap: Record<string, number> = {};\r\n    depots.forEach((depot, index) => {\r\n      depotOrderMap[depot.name] = index + 1; // 1-based order\r\n    });\r\n\r\n    const tripBookings = bookings\r\n      .filter(b => b.trip_id === trip.id)\r\n      .sort((a, b) => {\r\n        const orderA = depotOrderMap[a.destination_depot_name] || 999;\r\n        const orderB = depotOrderMap[b.destination_depot_name] || 999;\r\n        return orderA - orderB;\r\n      });\r\n\r\n    // Bookings Header\r\n    doc.setFontSize(11);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text(`Bookings (${tripBookings.length} items)`, 14, y);\r\n    y += 8;\r\n\r\n    // Draw line\r\n    doc.setDrawColor(200);\r\n    doc.line(14, y - 2, pageWidth - 14, y - 2);\r\n\r\n    tripBookings.forEach((booking, index) => {\r\n      // Check if we need a new page\r\n      if (y > 260) {\r\n        doc.addPage();\r\n        y = 15;\r\n      }\r\n\r\n      // Booking card\r\n      doc.setFillColor(245, 245, 245);\r\n      doc.rect(14, y, pageWidth - 28, 8, 'F');\r\n\r\n      doc.setFontSize(10);\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.text(`${index + 1}. ${booking.receipt_number} - ${booking.destination_depot_name}`, 16, y + 5);\r\n      y += 10;\r\n\r\n      doc.setFont('helvetica', 'normal');\r\n      doc.setFontSize(9);\r\n\r\n      // Sender\r\n      doc.text(`Sender: ${booking.sender_name} | ${booking.sender_phone}`, 16, y); y += 4;\r\n      doc.text(`From: ${booking.origin_depot_name}  To: ${booking.destination_depot_name}`, 16, y); y += 4;\r\n      doc.text(`Amount: Rs. ${(Number(booking.total_amount) || 0).toLocaleString('en-IN')}`, 16, y); y += 5;\r\n\r\n      // Receivers and packages\r\n      if (Array.isArray(booking.receivers)) {\r\n        booking.receivers.forEach((receiver: any, rIdx: number) => {\r\n          if (y > 265) { doc.addPage(); y = 15; }\r\n          doc.setFont('helvetica', 'bold');\r\n          doc.text(`  Receiver ${rIdx + 1}: ${receiver.name} | ${receiver.phone}`, 16, y); y += 4;\r\n          doc.setFont('helvetica', 'normal');\r\n          if (receiver.address) {\r\n            doc.text(`    Address: ${receiver.address}`, 16, y); y += 4;\r\n          }\r\n          // Packages\r\n          if (Array.isArray(receiver.packages)) {\r\n            receiver.packages.forEach((pkg: any) => {\r\n              if (y > 265) { doc.addPage(); y = 15; }\r\n              doc.text(`    - ${pkg.size}: ${pkg.quantity} pcs @ Rs.${pkg.price_per_unit || 0} = Rs.${pkg.total_price || 0}`, 16, y);\r\n              y += 4;\r\n            });\r\n          }\r\n        });\r\n      }\r\n      y += 4;\r\n    });\r\n\r\n    // Footer\r\n    if (y > 260) { doc.addPage(); y = 15; }\r\n    y += 5;\r\n    doc.setDrawColor(200);\r\n    doc.line(14, y, pageWidth - 14, y);\r\n    y += 8;\r\n    doc.setFontSize(8);\r\n    doc.text(`Generated on: ${new Date().toLocaleString('en-IN')}`, 14, y);\r\n    doc.text('Driver Signature: _________________', pageWidth - 80, y);\r\n\r\n    // Save\r\n    doc.save(`DriverMemo_${trip.trip_number || trip.id}_${new Date().toISOString().split('T')[0]}.pdf`);\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'in_transit':\r\n        return 'bg-blue-100 text-blue-700';\r\n      case 'loading':\r\n      case 'planned':\r\n        return 'bg-orange-100 text-orange-700';\r\n      case 'completed':\r\n      case 'delivered':\r\n        return 'bg-green-100 text-green-700';\r\n      case 'booked':\r\n        return 'bg-yellow-100 text-yellow-700';\r\n      case 'cancelled':\r\n        return 'bg-red-100 text-red-700';\r\n      default:\r\n        return 'bg-gray-100 text-gray-700';\r\n    }\r\n  };\r\n\r\n  const formatDate = (dateStr: string) => {\r\n    if (!dateStr) return '-';\r\n    return new Date(dateStr).toLocaleString('en-IN', {\r\n      month: 'short',\r\n      day: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  // Get total packages for a booking\r\n  const getPackageCount = (booking: Booking) => {\r\n    let count = 0;\r\n    if (Array.isArray(booking.receivers)) {\r\n      booking.receivers.forEach((r: any) => {\r\n        if (Array.isArray(r.packages)) {\r\n          r.packages.forEach((p: any) => {\r\n            count += Number(p.quantity) || 0;\r\n          });\r\n        }\r\n      });\r\n    }\r\n    return count;\r\n  };\r\n\r\n  // Filter bookings for deliveries tab (in_transit or delivered)\r\n  // Exclude 'booked' status for safety (should already be filtered out for depot managers)\r\n  const deliveryBookings = bookings.filter(b =>\r\n    b.status !== 'booked' && ( // Additional safety filter\r\n      statusFilter === 'all'\r\n        ? ['in_transit', 'delivered'].includes(b.status)\r\n        : b.status === statusFilter\r\n    )\r\n  );\r\n\r\n  // Filter trips\r\n  const filteredTrips = trips.filter(t =>\r\n    statusFilter === 'all' || t.status === statusFilter\r\n  );\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"p-8\">\r\n        <div className=\"text-center py-12\">\r\n          <div className=\"animate-spin w-8 h-8 border-4 border-orange-500 border-t-transparent rounded-full mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">Loading trips and deliveries...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-8\">\r\n      <div className=\"mb-8\">\r\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">Trips & Deliveries</h1>\r\n        <p className=\"text-gray-600\">Track all trips and manage deliveries</p>\r\n      </div>\r\n\r\n      {/* Offline Warning */}\r\n      {!isOnline && (\r\n        <div className=\"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-lg\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <span className=\"text-xl\">‚ö†Ô∏è</span>\r\n            <div>\r\n              <span className=\"font-medium text-amber-800\">You're currently offline. </span>\r\n              <span className=\"text-amber-700\">Delivery updates will be synced when you're back online.</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Tabs */}\r\n      <div className=\"flex flex-wrap gap-4 mb-6 border-b border-gray-200\">\r\n        <button\r\n          onClick={() => { setActiveTab('trips'); setStatusFilter('all'); }}\r\n          className={`px-6 py-3 font-medium border-b-2 transition-colors ${activeTab === 'trips'\r\n            ? 'border-orange-500 text-orange-600'\r\n            : 'border-transparent text-gray-600 hover:text-gray-900'\r\n            }`}\r\n        >\r\n          All Trips ({trips.length})\r\n        </button>\r\n        <button\r\n          onClick={() => { setActiveTab('deliveries'); setStatusFilter('all'); }}\r\n          className={`px-6 py-3 font-medium border-b-2 transition-colors ${activeTab === 'deliveries'\r\n            ? 'border-orange-500 text-orange-600'\r\n            : 'border-transparent text-gray-600 hover:text-gray-900'\r\n            }`}\r\n        >\r\n          Deliveries ({bookings.filter(b => ['in_transit', 'delivered'].includes(b.status)).length})\r\n        </button>\r\n      </div>\r\n\r\n      {/* Status Filter */}\r\n      <div className=\"mb-6 flex gap-2 flex-wrap\">\r\n        <button\r\n          onClick={() => setStatusFilter('all')}\r\n          className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${statusFilter === 'all' ? 'bg-orange-500 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n            }`}\r\n        >\r\n          All\r\n        </button>\r\n        {activeTab === 'trips' ? (\r\n          <>\r\n            <button\r\n              onClick={() => setStatusFilter('in_transit')}\r\n              className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${statusFilter === 'in_transit' ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                }`}\r\n            >\r\n              In Transit\r\n            </button>\r\n            <button\r\n              onClick={() => setStatusFilter('completed')}\r\n              className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${statusFilter === 'completed' ? 'bg-green-500 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                }`}\r\n            >\r\n              Completed\r\n            </button>\r\n          </>\r\n        ) : (\r\n          <>\r\n            <button\r\n              onClick={() => setStatusFilter('in_transit')}\r\n              className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${statusFilter === 'in_transit' ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                }`}\r\n            >\r\n              In Transit\r\n            </button>\r\n            <button\r\n              onClick={() => setStatusFilter('delivered')}\r\n              className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${statusFilter === 'delivered' ? 'bg-green-500 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                }`}\r\n            >\r\n              Delivered\r\n            </button>\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      {/* Trips View */}\r\n      {activeTab === 'trips' && (\r\n        <div className=\"space-y-4\">\r\n          {filteredTrips.length > 0 ? filteredTrips.map((trip) => (\r\n            <div key={trip.id} className=\"bg-white rounded-xl border border-gray-200 overflow-hidden\">\r\n              <div className=\"p-6\">\r\n                <div className=\"flex items-start justify-between mb-4\">\r\n                  <div>\r\n                    <h3 className=\"font-bold text-gray-900 mb-1\">\r\n                      {trip.trip_number || trip.id}\r\n                    </h3>\r\n                    <p className=\"text-sm text-gray-600\">{trip.id}</p>\r\n                  </div>\r\n                  <span className={`px-3 py-1 rounded-full text-xs font-medium ${getStatusColor(trip.status)}`}>\r\n                    {trip.status?.replace('_', ' ')}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4\">\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500 mb-1\">Driver</p>\r\n                    <p className=\"text-sm font-medium text-gray-900\">{trip.driver_name}</p>\r\n                    {trip.driver_phone && (\r\n                      <p className=\"text-xs text-gray-500\">{trip.driver_phone}</p>\r\n                    )}\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500 mb-1\">Vehicle</p>\r\n                    <p className=\"text-sm font-medium text-gray-900\">{trip.vehicle_number}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500 mb-1\">Trip Cost</p>\r\n                    <p className=\"text-sm font-medium text-red-600\">\r\n                      ‚Çπ{(Number(trip.trip_cost) || 0).toLocaleString('en-IN')}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500 mb-1\">Revenue</p>\r\n                    <p className=\"text-sm font-medium text-green-600\">\r\n                      ‚Çπ{bookings\r\n                        .filter(b => b.status === 'in_transit' || b.status === 'delivered')\r\n                        .reduce((sum, b) => sum + (Number(b.total_amount) || 0), 0)\r\n                        .toLocaleString('en-IN')}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500 mb-1\">Delivery Progress</p>\r\n                    <p className=\"text-sm font-medium text-gray-900\">\r\n                      {trip.delivered_bookings || 0}/{trip.total_bookings || 0} delivered\r\n                    </p>\r\n                    {/* Progress bar */}\r\n                    {trip.total_bookings > 0 && (\r\n                      <div className=\"mt-1 w-full bg-gray-200 rounded-full h-2\">\r\n                        <div\r\n                          className={`h-2 rounded-full transition-all ${trip.delivered_bookings === trip.total_bookings\r\n                            ? 'bg-green-500'\r\n                            : 'bg-orange-500'\r\n                            }`}\r\n                          style={{ width: `${(trip.delivered_bookings / trip.total_bookings) * 100}%` }}\r\n                        ></div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg\">\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500 mb-1\">Departure</p>\r\n                    <p className=\"text-sm font-medium text-gray-900\">{formatDate(trip.departure_time)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500 mb-1\">ETA</p>\r\n                    <p className=\"text-sm font-medium text-gray-900\">{formatDate(trip.arrival_time)}</p>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Auto-completion notice */}\r\n                {trip.status === 'in_transit' && trip.total_bookings > 0 && (\r\n                  <div className=\"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                    <p className=\"text-xs text-blue-700\">\r\n                      ‚ÑπÔ∏è This trip will auto-complete when all {trip.total_bookings} receipts are marked as delivered.\r\n                    </p>\r\n                  </div>\r\n                )}\r\n\r\n                <div className=\"flex gap-3 mt-4 flex-wrap\">\r\n                  <button\r\n                    onClick={() => downloadDriverMemo(trip)}\r\n                    className=\"px-4 py-2 text-sm bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors\"\r\n                  >\r\n                    üìÑ Download Memo\r\n                  </button>\r\n                  {trip.status === 'planned' && (\r\n                    <button\r\n                      onClick={() => handleUpdateTripStatus(trip.id, 'in_transit')}\r\n                      className=\"px-4 py-2 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors\"\r\n                    >\r\n                      Start Trip\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )) : (\r\n            <div className=\"bg-white rounded-xl border border-gray-200 p-12 text-center\">\r\n              <p className=\"text-gray-500 text-lg\">No trips found</p>\r\n              <p className=\"text-gray-400 text-sm mt-2\">Create a new trip from the Trip Creation page</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Deliveries View */}\r\n      {activeTab === 'deliveries' && (\r\n        <div className=\"bg-white rounded-xl border border-gray-200\">\r\n          {/* Mobile Card Layout (visible on small screens) */}\r\n          <div className=\"md:hidden divide-y divide-gray-200\">\r\n            {deliveryBookings.length > 0 ? deliveryBookings.map((booking) => (\r\n              <div key={booking.id} className=\"p-4\">\r\n                {/* Header: Receipt + Status */}\r\n                <div className=\"flex items-start justify-between mb-3\">\r\n                  <div>\r\n                    <p className=\"font-bold text-gray-900\">{booking.receipt_number}</p>\r\n                    <p className=\"text-xs text-gray-500\">{formatDate(booking.created_at)}</p>\r\n                  </div>\r\n                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(booking.status)}`}>\r\n                    {booking.status?.replace('_', ' ')}\r\n                  </span>\r\n                </div>\r\n\r\n                {/* Sender Info */}\r\n                <div className=\"mb-2\">\r\n                  <p className=\"text-sm font-medium text-gray-900\">{booking.sender_name}</p>\r\n                  <p className=\"text-xs text-gray-500\">{booking.sender_phone}</p>\r\n                </div>\r\n\r\n                {/* Route + Details */}\r\n                <div className=\"flex items-center justify-between text-sm mb-3 p-2 bg-gray-50 rounded\">\r\n                  <span className=\"text-gray-600\">{booking.origin_depot_name} ‚Üí {booking.destination_depot_name}</span>\r\n                  <span className=\"font-medium text-gray-900\">{getPackageCount(booking)} pkgs</span>\r\n                </div>\r\n\r\n                {/* Amount + Payment Method */}\r\n                <div className=\"flex items-center justify-between mb-3\">\r\n                  <span className=\"text-lg font-bold text-green-600\">‚Çπ{(Number(booking.total_amount) || 0).toLocaleString('en-IN')}</span>\r\n                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${booking.payment_method === 'cash' ? 'bg-green-100 text-green-700' :\r\n                    booking.payment_method === 'online' ? 'bg-purple-100 text-purple-700' :\r\n                      booking.payment_method === 'credit' ? 'bg-yellow-100 text-yellow-700' :\r\n                        booking.payment_method === 'to_pay' ? 'bg-orange-100 text-orange-700' :\r\n                          'bg-gray-100 text-gray-700'\r\n                    }`}>\r\n                    {booking.payment_method === 'cash' ? 'Cash' :\r\n                      booking.payment_method === 'online' ? 'Online' :\r\n                        booking.payment_method === 'credit' ? 'Credit' :\r\n                          booking.payment_method === 'to_pay' ? 'To-Pay' :\r\n                            booking.payment_method || 'N/A'}\r\n                  </span>\r\n                </div>\r\n\r\n                {/* Pending sync indicator */}\r\n                {pendingDeliveries.has(booking.id) && (\r\n                  <div className=\"mb-2 text-xs text-amber-600 flex items-center gap-1\">\r\n                    <span className=\"animate-pulse\">‚è≥</span> Pending sync\r\n                  </div>\r\n                )}\r\n\r\n                {/* ACTION BUTTON - Prominent on mobile */}\r\n                {booking.status === 'in_transit' && booking.payment_method === 'to_pay' ? (\r\n                  <div className=\"flex flex-col gap-2\">\r\n                    <select\r\n                      value={toPayCollectionMethods[booking.id] || ''}\r\n                      onChange={(e) => setToPayCollectionMethods({\r\n                        ...toPayCollectionMethods,\r\n                        [booking.id]: e.target.value\r\n                      })}\r\n                      className=\"w-full text-sm border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500\"\r\n                    >\r\n                      <option value=\"\">Select Payment Method</option>\r\n                      <option value=\"cash\">Cash</option>\r\n                      <option value=\"online\">Online/UPI</option>\r\n                    </select>\r\n                    <button\r\n                      onClick={() => handleMarkDelivered(booking.id, toPayCollectionMethods[booking.id])}\r\n                      disabled={!toPayCollectionMethods[booking.id]}\r\n                      className={`w-full py-3 rounded-lg font-medium text-center ${toPayCollectionMethods[booking.id]\r\n                        ? 'bg-green-500 text-white hover:bg-green-600'\r\n                        : 'bg-gray-200 text-gray-400 cursor-not-allowed'\r\n                        }`}\r\n                    >\r\n                      {!isOnline ? 'üì§ Mark Delivered (Offline)' : '‚úì Mark Delivered'}\r\n                    </button>\r\n                  </div>\r\n                ) : booking.status === 'in_transit' ? (\r\n                  <button\r\n                    onClick={() => handleMarkDelivered(booking.id)}\r\n                    className=\"w-full py-3 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600\"\r\n                  >\r\n                    {!isOnline ? 'üì§ Mark Delivered (Offline)' : '‚úì Mark Delivered'}\r\n                  </button>\r\n                ) : booking.status === 'delivered' ? (\r\n                  <div className=\"w-full py-3 bg-green-100 text-green-700 rounded-lg font-medium text-center\">\r\n                    ‚úì Delivered {pendingDeliveries.has(booking.id) && '(syncing...)'}\r\n                  </div>\r\n                ) : null}\r\n              </div>\r\n            )) : (\r\n              <div className=\"p-12 text-center text-gray-500\">\r\n                No deliveries found\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Desktop Table Layout (hidden on mobile) */}\r\n          <div className=\"hidden md:block overflow-x-auto\">\r\n            <table className=\"w-full\">\r\n              <thead className=\"bg-gray-50 border-b border-gray-200\">\r\n                <tr>\r\n                  <th className=\"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Receipt #\r\n                  </th>\r\n                  <th className=\"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Sender\r\n                  </th>\r\n                  <th className=\"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Route\r\n                  </th>\r\n                  <th className=\"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Packages\r\n                  </th>\r\n                  <th className=\"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Amount\r\n                  </th>\r\n                  <th className=\"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Payment\r\n                  </th>\r\n                  <th className=\"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Status\r\n                  </th>\r\n                  <th className=\"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Actions\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"divide-y divide-gray-200\">\r\n                {deliveryBookings.length > 0 ? deliveryBookings.map((booking) => (\r\n                  <tr key={booking.id} className=\"hover:bg-gray-50\">\r\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                      <p className=\"font-medium text-gray-900\">{booking.receipt_number}</p>\r\n                      <p className=\"text-xs text-gray-500\">{formatDate(booking.created_at)}</p>\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      <p className=\"font-medium text-gray-900\">{booking.sender_name}</p>\r\n                      <p className=\"text-xs text-gray-500\">{booking.sender_phone}</p>\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      <p className=\"text-sm text-gray-900\">\r\n                        {booking.origin_depot_name} ‚Üí {booking.destination_depot_name}\r\n                      </p>\r\n                    </td>\r\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                      <p className=\"text-sm font-medium text-gray-900\">{getPackageCount(booking)}</p>\r\n                    </td>\r\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                      <p className=\"text-sm font-medium text-green-600\">\r\n                        ‚Çπ{(Number(booking.total_amount) || 0).toLocaleString('en-IN')}\r\n                      </p>\r\n                    </td>\r\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                      <span className={`px-2 py-1 rounded-full text-xs font-medium ${booking.payment_method === 'cash' ? 'bg-green-100 text-green-700' :\r\n                        booking.payment_method === 'online' ? 'bg-purple-100 text-purple-700' :\r\n                          booking.payment_method === 'credit' ? 'bg-yellow-100 text-yellow-700' :\r\n                            booking.payment_method === 'to_pay' ? 'bg-orange-100 text-orange-700' :\r\n                              'bg-gray-100 text-gray-700'\r\n                        }`}>\r\n                        {booking.payment_method === 'cash' ? 'Cash' :\r\n                          booking.payment_method === 'online' ? 'Online' :\r\n                            booking.payment_method === 'credit' ? 'Credit' :\r\n                              booking.payment_method === 'to_pay' ? 'To-Pay' :\r\n                                booking.payment_method || 'N/A'}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                      <span className={`px-3 py-1 rounded-full text-xs font-medium ${getStatusColor(booking.status)}`}>\r\n                        {booking.status?.replace('_', ' ')}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                      {/* Pending sync indicator */}\r\n                      {pendingDeliveries.has(booking.id) && (\r\n                        <span className=\"inline-flex items-center gap-1 text-xs text-amber-600 mb-1\">\r\n                          <span className=\"animate-pulse\">‚è≥</span> Pending sync\r\n                        </span>\r\n                      )}\r\n                      {booking.status === 'in_transit' && booking.payment_method === 'to_pay' ? (\r\n                        <div className=\"flex flex-col gap-2 min-w-[140px]\">\r\n                          <select\r\n                            value={toPayCollectionMethods[booking.id] || ''}\r\n                            onChange={(e) => setToPayCollectionMethods({\r\n                              ...toPayCollectionMethods,\r\n                              [booking.id]: e.target.value\r\n                            })}\r\n                            className=\"text-xs border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-orange-500\"\r\n                          >\r\n                            <option value=\"\">Select Payment</option>\r\n                            <option value=\"cash\">Cash</option>\r\n                            <option value=\"online\">Online/UPI</option>\r\n                          </select>\r\n                          <button\r\n                            onClick={() => handleMarkDelivered(booking.id, toPayCollectionMethods[booking.id])}\r\n                            disabled={!toPayCollectionMethods[booking.id]}\r\n                            className={`text-sm font-medium px-2 py-1 rounded ${toPayCollectionMethods[booking.id]\r\n                              ? 'text-green-600 hover:text-green-700 hover:bg-green-50'\r\n                              : 'text-gray-400 cursor-not-allowed bg-gray-50'\r\n                              }`}\r\n                          >\r\n                            {!isOnline ? 'üì§ Mark (Offline)' : 'Mark Delivered'}\r\n                          </button>\r\n                        </div>\r\n                      ) : booking.status === 'in_transit' ? (\r\n                        <button\r\n                          onClick={() => handleMarkDelivered(booking.id)}\r\n                          className=\"text-sm text-green-600 hover:text-green-700 font-medium\"\r\n                        >\r\n                          {!isOnline ? 'üì§ Mark (Offline)' : 'Mark Delivered'}\r\n                        </button>\r\n                      ) : booking.status === 'delivered' ? (\r\n                        <span className=\"text-sm text-green-600\">\r\n                          ‚úì Delivered {pendingDeliveries.has(booking.id) && '(syncing...)'}\r\n                        </span>\r\n                      ) : null}\r\n                    </td>\r\n                  </tr>\r\n                )) : (\r\n                  <tr>\r\n                    <td colSpan={8} className=\"px-6 py-12 text-center text-gray-500\">\r\n                      No deliveries found\r\n                    </td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"file":"assets/TripsDeliveries-BJgJCURR.js"}