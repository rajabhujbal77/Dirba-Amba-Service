import{r as n,j as e}from"./vendor-radix-BK0gN1wx.js";import{k as j}from"./index-ByUUsPfb.js";import"./vendor-react-BRY8hXab.js";import"./vendor-pdf-DRk-497H.js";import"./vendor-state-B-0uGrSJ.js";function S({assignedDepotId:l}){const[x,p]=n.useState({from:"",to:""}),[a,N]=n.useState(null),[r,f]=n.useState(null),[d,g]=n.useState(!1);n.useEffect(()=>{l&&h()},[l]);const h=async()=>{if(l){g(!0);try{const t=x.from||void 0,s=x.to||void 0,[m,i]=await Promise.all([j.getPaymentReport(l,t,s),j.getDeliveryReport(l,t,s)]);N(m),f(i)}catch(t){console.error("Error loading reports:",t),alert("Failed to load reports")}finally{g(!1)}}},b=()=>{h()},u=(t,s)=>{if(!t||t.length===0){alert("No data to export");return}const m=Object.keys(t[0]).join(","),i=t.map(D=>Object.values(D).map(c=>typeof c=="string"&&c.includes(",")?`"${c}"`:c).join(",")),v=[m,...i].join(`
`),w=new Blob([v],{type:"text/csv"}),y=URL.createObjectURL(w),o=document.createElement("a");o.href=y,o.download=`${s}_${new Date().toISOString().split("T")[0]}.csv`,o.click(),URL.revokeObjectURL(y)};return l?e.jsxs("div",{className:"p-4 md:p-8 overflow-x-hidden",children:[e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-2",children:"Depot Reports"}),e.jsx("p",{className:"text-gray-600 text-sm md:text-base",children:"Payment and delivery tracking for your depot"})]}),e.jsx("div",{className:"bg-white rounded-xl p-4 md:p-6 border border-gray-200 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 md:gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),e.jsx("input",{type:"date",value:x.from,onChange:t=>p({...x,from:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),e.jsx("input",{type:"date",value:x.to,onChange:t=>p({...x,to:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),e.jsx("div",{className:"sm:self-end",children:e.jsx("button",{onClick:b,disabled:d,className:"w-full sm:w-auto px-6 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors disabled:bg-gray-300",children:d?"Loading...":"Apply Filter"})})]})}),e.jsxs("div",{className:"bg-white rounded-xl p-4 md:p-6 border border-gray-200 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-4",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-gray-900",children:"ðŸ’µ Payment Report (To-Pay Collections)"}),e.jsx("button",{onClick:()=>a&&u(a.payments,"payment_report"),className:"w-full sm:w-auto px-4 py-2 text-sm bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:"Export Excel"})]}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 md:p-4 rounded-lg",children:[e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Total Collections"}),e.jsxs("p",{className:"text-lg md:text-2xl font-bold text-blue-600",children:["â‚¹",a.summary.total.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"bg-green-50 p-3 md:p-4 rounded-lg",children:[e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Cash"}),e.jsxs("p",{className:"text-lg md:text-2xl font-bold text-green-600",children:["â‚¹",a.summary.cash.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"bg-purple-50 p-3 md:p-4 rounded-lg",children:[e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Online/UPI"}),e.jsxs("p",{className:"text-lg md:text-2xl font-bold text-purple-600",children:["â‚¹",a.summary.online.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 md:p-4 rounded-lg",children:[e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Total Payments"}),e.jsx("p",{className:"text-lg md:text-2xl font-bold text-gray-700",children:a.summary.count})]})]}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Receipt"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Destination"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Amount"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.payments.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:new Date(t.date).toLocaleDateString("en-IN")}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:t.receipt_number}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:t.customer_name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:t.destination}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.payment_method==="cash"?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700"}`,children:t.payment_method==="cash"?"Cash":"Online"})}),e.jsxs("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:["â‚¹",t.amount.toLocaleString("en-IN")]})]},s))})]})}),e.jsx("div",{className:"md:hidden space-y-3",children:a.payments.map((t,s)=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:t.receipt_number}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(t.date).toLocaleDateString("en-IN")})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.payment_method==="cash"?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700"}`,children:t.payment_method==="cash"?"Cash":"Online"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 truncate mr-2",children:t.customer_name}),e.jsxs("span",{className:"font-bold text-gray-900",children:["â‚¹",t.amount.toLocaleString("en-IN")]})]})]},s))})]}),!a&&!d&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No payment data available"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 md:p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-4",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-gray-900",children:"ðŸ“¦ Delivery Report"}),e.jsx("button",{onClick:()=>r&&u(r.deliveries,"delivery_report"),className:"w-full sm:w-auto px-4 py-2 text-sm bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:"Export Excel"})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 md:p-4 rounded-lg",children:[e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Total Bookings"}),e.jsx("p",{className:"text-lg md:text-2xl font-bold text-blue-600",children:r.summary.total})]}),e.jsxs("div",{className:"bg-green-50 p-3 md:p-4 rounded-lg",children:[e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Delivered"}),e.jsx("p",{className:"text-lg md:text-2xl font-bold text-green-600",children:r.summary.delivered})]}),e.jsxs("div",{className:"bg-orange-50 p-3 md:p-4 rounded-lg",children:[e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-lg md:text-2xl font-bold text-orange-600",children:r.summary.pending})]}),e.jsxs("div",{className:"bg-purple-50 p-3 md:p-4 rounded-lg",children:[e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Total Packages"}),e.jsx("p",{className:"text-lg md:text-2xl font-bold text-purple-600",children:r.summary.totalPackages})]})]}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Receipt"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Destination"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Packages"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.deliveries.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:new Date(t.date).toLocaleDateString("en-IN")}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:t.receipt_number}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:t.customer_name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:t.destination}),e.jsx("td",{className:"px-4 py-3 text-sm text-center font-medium text-gray-900",children:t.packages}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:t.delivery_instructions.includes("Home")?"Home Delivery":"Pickup"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.status==="delivered"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:t.status==="delivered"?"Delivered":"Pending"})})]},s))})]})}),e.jsx("div",{className:"md:hidden space-y-3",children:r.deliveries.map((t,s)=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:t.receipt_number}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(t.date).toLocaleDateString("en-IN")})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.status==="delivered"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:t.status==="delivered"?"Delivered":"Pending"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 truncate",children:t.customer_name}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[t.packages," pkg"]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.destination," â€¢ ",t.delivery_instructions.includes("Home")?"Home Delivery":"Pickup"]})]})]},s))})]}),!r&&!d&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No delivery data available"})]})]}):e.jsx("div",{className:"p-4 md:p-8",children:e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"No depot assigned"})})})}export{S as default};
//# sourceMappingURL=DepotReports-5655924a.js.map
